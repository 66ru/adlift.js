/*! adlift.js - v0.0.2 - 2014-06-05
* Copyright (c) 2014 adlift.ru; Licensed under ISC */
!function(){"use strict";var a=function(){function a(){return e+=1}function b(b,e,f){if(!b||"undefined"==typeof b||"function"!=typeof e)return!1;f=Math.abs(f)||5e3;var g="adliftCallback_"+a(),h=0;window[g]=function(a){clearTimeout(h),e(a,"success"),window[g]=null,d(g)},c(b,g),h=setTimeout(function(){window[g]=function(){window[g]=null},e(null,"error"),d(g)},f)}function c(a,b){if(a&&b&&"string"==typeof a&&"string"==typeof b){-1!==a.indexOf("=?")?a=a.replace(f,"="+b):a+=(-1===a.indexOf("?")?"?jsonp=":"&jsonp=")+b;var c=document.createElement("script");c.id="jsonp-"+b,c.type="text/javascript",c.charset="utf-8",c.src=a,document.getElementsByTagName("head")[0].appendChild(c)}}function d(a){var b=document.getElementById("jsonp-"+a);if(b){b.parentNode.removeChild(b);for(var c in b)b.hasOwnProperty(c)&&delete b[c]}}var e=0,f=/\=\?/g,g=function(c){function d(d,e,f){function g(b){var c=/<script\b[^>]*>([\s\S]*?)<\/script>/im,d=j.html.match(c);if(d){var e=j.html.replace(d[0],""),f=document.createElement("script"),g="adlift_script_"+a();window[g]=function(){f.parentNode.removeChild(f),window[g]=null,delete window[g]},f.innerHTML=d[1]+"; "+g+"();",document.getElementById(b).innerHTML=e,document.getElementById(b).appendChild(f)}else document.getElementById(b).innerHTML=j.html}function h(a){if("function"!=typeof a)throw new Error("No callback passed");a(j.banner_available)}function i(a){for(var b=a.length;b;)b-=1,a[b].func.apply(j,a[b].args)}var j=this,k=[],l=!1,m=c+d+".js",n=[];"function"==typeof window.getPt&&n.push({key:"ptrk",val:window.getPt()}),"string"==typeof e&&n.push({key:"code",val:e});var o=n.length,p=[];for(o&&(m+="?");o;)o-=1,p.push(n[o].key+"="+n[o].val);return m+=p.join("&"),f?(document.write("<script type='text/javascript' src='"+m),void document.write("'></script>")):(b(m,function(a,b){if("success"!==b)throw new Error("Failed to get banner for slot: "+d);a=JSON.parse(a),j.html=a.banner_html,j.id=a.slot_id,j.banner_available=a.banner_available,l=!0,i(k)}),{writeTo:function(a){return l?(g(a),this):(k.push({func:g,args:arguments}),this)},isAvailable:function(a){return l?h(a):k.push({func:h,args:arguments}),this}})}c=c||"http://show.adlift.ru/",this.globalCode=null,this.getBanner=function(a,b){return b=b||this.globalCode,new d(a,b)},this.writeSync=function(a,b){return b=b||this.globalCode,new d(a,b,!0)}};return g};"function"==typeof define&&define.amd?define(a):window.Adlift=a()}();