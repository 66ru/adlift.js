/*! adlift.js - v0.0.1 - 2014-04-16
* adlift.ru
* Copyright (c) 2014 ; Licensed  */
!function(){"use strict";var a=function(){function a(){return e+=1}function b(b,e,f){if(!b||"undefined"==typeof b||"function"!=typeof e)return!1;f=Math.abs(f)||5e3;var g="adliftCallback_"+a(),h=0;window[g]=function(a){clearTimeout(h),e(a,"success"),window[g]=null,d(g)},c(b,g),h=setTimeout(function(){window[g]=function(){window[g]=null},e(null,"error"),d(g)},f)}function c(a,b){if(a&&b&&"string"==typeof a&&"string"==typeof b){-1!==a.indexOf("=?")?a=a.replace(f,"="+b):a+=(-1===a.indexOf("?")?"?jsonp=":"&jsonp=")+b;var c=document.createElement("script");c.id="jsonp-"+b,c.type="text/javascript",c.charset="utf-8",c.src=a,document.getElementsByTagName("head")[0].appendChild(c)}}function d(a){var b=document.getElementById("jsonp-"+a);if(b){b.parentNode.removeChild(b);for(var c in b)b.hasOwnProperty(c)&&delete b[c]}}var e=0,f=/\=\?/g,g=function(c){function d(d,e){function f(b){var c=/<script\b[^>]*>([\s\S]*?)<\/script>/im,d=i.html.match(c);if(d){var e=i.html.replace(d[0],""),f=document.createElement("script"),g="adlift_script_"+a();window[g]=function(){f.parentNode.removeChild(f),window[g]=null,delete window[g]},f.innerHTML=d[1]+"; "+g+"();",document.getElementById(b).innerHTML=e,document.getElementById(b).appendChild(f)}else document.getElementById(b).innerHTML=i.html}function g(a){if("function"!=typeof a)throw new Error("No callback passed");a(i.banner_available)}function h(a){for(var b=a.length;b;)b-=1,a[b].func.apply(i,a[b].args)}var i=this,j=[],k=!1,l=c+d+".js",m=[];"string"==typeof window.ptrk&&m.push({key:"ptrk",val:window.ptrk}),"string"==typeof e&&m.push({key:"code",val:e});var n=m.length,o=[];for(n&&(l+="?");n;)n-=1,o.push(m[n].key+"="+m[n].val);return l+=o.join("&"),b(l,function(a,b){if("success"!==b)throw new Error("Failed to get banner for slot: "+d);a=JSON.parse(a),i.html=a.banner_html,i.id=a.slot_id,i.banner_available=a.banner_available,k=!0,h(j)}),{writeTo:function(a){return k?(f(a),this):(j.push({func:f,args:arguments}),this)},isAvailable:function(a){return k?g(a):j.push({func:g,args:arguments}),this}}}c=c||"http://show.adlift.ru/",this.globalCode=null,this.getBanner=function(a,b){return b=b||this.globalCode,new d(a,b)}};return g};"undefined"!=typeof define&&define(a),window.Adlift=a}();